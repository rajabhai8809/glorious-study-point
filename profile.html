<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - EduSecure</title>
    <link rel="stylesheet" href="assets/css/output.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
</head>
<body class="bg-slate-100 dark:bg-slate-900 min-h-screen pb-20 md:pb-0 transition-colors">

    <!-- Navbar -->
    <nav class="bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 px-4 md:px-6 py-3 md:py-4">
        <div class="container mx-auto flex justify-between items-center">
            <a href="dashboard.html" class="font-bold text-lg md:text-xl text-primary flex items-center gap-2 hover:opacity-80 transition-opacity">
                <i data-lucide="chevron-left" class="w-5 h-5 md:w-6 md:h-6"></i>
                <span>Back</span> <span class="hidden sm:inline">to Dashboard</span>
            </a>
            <button onclick="toggleTheme()" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-600 dark:text-slate-300">
                <i data-lucide="moon" class="w-5 h-5 hidden dark:block"></i>
                <i data-lucide="sun" class="w-5 h-5 block dark:hidden"></i>
            </button>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-6 md:py-8 max-w-2xl">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
            
            <!-- Header / Cover -->
            <div class="hidden sm:block h-32 bg-gradient-to-r from-blue-500 to-purple-600 relative"></div>

            <div class="px-4 sm:px-8 pb-8">
                <!-- Profile Image -->
                <div class="relative mt-6 sm:-mt-12 mb-8 flex flex-col sm:flex-row sm:justify-between sm:items-end gap-4">
                    <div class="relative group mx-auto sm:mx-0">
                        <img id="profile-image" src="https://ui-avatars.com/api/?name=User&background=2563EB&color=fff" class="w-24 h-24 rounded-full border-4 border-white dark:border-slate-800 object-cover bg-white">
                        <button onclick="triggerProfileUpload()" class="absolute bottom-0 right-0 bg-white dark:bg-slate-700 p-2 rounded-full shadow-md border border-slate-200 dark:border-slate-600 hover:bg-slate-50 transition-colors" title="Change Photo">
                            <i data-lucide="camera" class="w-4 h-4 text-slate-600 dark:text-slate-300"></i>
                        </button>
                        <input type="file" id="profile-upload" class="hidden" accept="image/*" onchange="previewProfileImage(event)">
                    </div>
                    
                    <!-- Edit Button (Visible in View Mode) -->
                    <div id="profile-view-mode" class="w-full sm:w-auto flex justify-center sm:block">
                        <button onclick="toggleEditProfile()" class="btn-secondary flex items-center gap-2 w-full sm:w-auto justify-center">
                            <i data-lucide="edit-2" class="w-4 h-4"></i> Edit Profile
                        </button>
                    </div>
                </div>

                <!-- View Mode -->
                <div id="profile-view-mode-content" class="text-center sm:text-left">
                    <h1 id="profile-name" class="text-2xl font-bold text-slate-900 dark:text-white mb-1">Loading...</h1>
                    <p id="profile-details" class="text-slate-500 dark:text-slate-400 mb-6">...</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-left">
                        <div class="p-4 bg-slate-50 dark:bg-slate-900 rounded-xl border border-slate-100 dark:border-slate-700">
                            <p class="text-xs text-slate-500 uppercase font-bold mb-1">Account Type</p>
                            <p class="font-medium text-slate-900 dark:text-white flex items-center gap-2"><i data-lucide="shield" class="w-4 h-4 text-primary"></i> Student</p>
                        </div>
                        <div class="p-4 bg-slate-50 dark:bg-slate-900 rounded-xl border border-slate-100 dark:border-slate-700">
                            <p class="text-xs text-slate-500 uppercase font-bold mb-1">Member Since</p>
                            <p class="font-medium text-slate-900 dark:text-white">Jan 2026</p>
                        </div>
                    </div>

                    <div class="mt-6 text-left">
                        <h3 class="font-bold text-lg text-slate-900 dark:text-white mb-2">About Me</h3>
                        <p id="profile-bio" class="text-slate-500 dark:text-slate-400">No bio added yet.</p>
                    </div>
                </div>

                <!-- Edit Mode (Hidden by default) -->
                <form id="profile-edit-mode" class="hidden space-y-4" onsubmit="saveProfileChanges(event)">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Full Name</label>
                        <input type="text" id="edit-name" class="w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 dark:text-white" required>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Class</label>
                            <select id="edit-class" class="w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 dark:text-white">
                                <option value="11">Class 11</option>
                                <option value="12">Class 12</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Stream</label>
                            <select id="edit-stream" class="w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 dark:text-white">
                                <option value="Science">Science</option>
                                <option value="Commerce">Commerce</option>
                                <option value="Arts">Arts</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Bio</label>
                        <textarea id="edit-bio" rows="3" class="w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 dark:text-white" placeholder="Tell us about yourself..."></textarea>
                    </div>

                    <div class="flex justify-end gap-3 pt-4">
                        <button type="button" onclick="toggleEditProfile()" class="px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg font-medium transition-colors">Cancel</button>
                        <button type="submit" class="btn-primary px-6 py-2">Save Changes</button>
                    </div>
                </form>

            </div>
        </div>

        <!-- Additional Settings Link -->
        <div class="mt-6 text-center space-y-3">
            <a href="settings.html" class="text-slate-500 hover:text-primary text-sm flex items-center justify-center gap-2">
                <i data-lucide="settings" class="w-4 h-4"></i> Account Settings
            </a>
            <button onclick="logout()" class="text-red-500 hover:text-red-600 text-sm flex items-center justify-center gap-2 w-full">
                <i data-lucide="log-out" class="w-4 h-4"></i> Sign Out
            </button>
        </div>
    </main>

    <!-- Mobile Bottom Nav -->
    <nav class="md:hidden fixed bottom-0 w-full bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 flex justify-around py-3 z-50">
        <a href="dashboard.html" class="flex flex-col items-center text-slate-400 hover:text-primary transition-colors"><i data-lucide="layout-dashboard" class="w-6 h-6"></i><span class="text-[10px] mt-1">Home</span></a>
        <a href="exam.html" class="flex flex-col items-center text-slate-400 hover:text-primary transition-colors"><i data-lucide="file-text" class="w-6 h-6"></i><span class="text-[10px] mt-1">Exams</span></a>
        <a href="notes.html" class="flex flex-col items-center text-slate-400 hover:text-primary transition-colors"><i data-lucide="book-open" class="w-6 h-6"></i><span class="text-[10px] mt-1">Notes</span></a>
        <a href="leaderboard.html" class="flex flex-col items-center text-slate-400 hover:text-primary transition-colors"><i data-lucide="trophy" class="w-6 h-6"></i><span class="text-[10px] mt-1">Rank</span></a>
        <a href="profile.html" class="flex flex-col items-center text-primary"><i data-lucide="user" class="w-6 h-6"></i><span class="text-[10px] mt-1">Profile</span></a>
    </nav>

    <script src="assets/js/main.js"></script>
    <script>
        lucide.createIcons();
        // Helper to toggle visibility of view/edit sections
        const originalToggle = window.toggleEditProfile;
        window.toggleEditProfile = function() {
            document.getElementById('profile-view-mode-content').classList.toggle('hidden');
            originalToggle(); // Call the function defined in main.js
        }
    </script>
</body>
</html>